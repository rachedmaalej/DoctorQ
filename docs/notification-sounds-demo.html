<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DoctorQ - Notification Sounds Demo</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1e3a5f 0%, #0f172a 100%);
      color: #e2e8f0;
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    .header {
      text-align: center;
      margin-bottom: 40px;
    }
    .header h1 { font-size: 2rem; color: #38bdf8; margin-bottom: 10px; }
    .header p { color: #94a3b8; }

    /* Queue Simulation */
    .simulation {
      background: #1e293b;
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
    }
    .simulation h2 {
      color: #38bdf8;
      margin-bottom: 20px;
      font-size: 1.2rem;
    }
    .queue-display {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin-bottom: 30px;
    }
    .position-card {
      background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
      border-radius: 16px;
      padding: 30px 50px;
      text-align: center;
    }
    .position-card .label { font-size: 0.9rem; opacity: 0.9; }
    .position-card .number {
      font-size: 4rem;
      font-weight: 700;
      line-height: 1;
      margin: 10px 0;
    }
    .position-card .sublabel { font-size: 0.85rem; opacity: 0.8; }
    .position-card.highlight {
      animation: pulse-highlight 0.5s ease-out;
    }
    @keyframes pulse-highlight {
      0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(56, 189, 248, 0.7); }
      50% { transform: scale(1.05); box-shadow: 0 0 20px 10px rgba(56, 189, 248, 0.3); }
      100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(56, 189, 248, 0); }
    }
    .sim-controls {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
    }
    .sim-btn {
      background: #334155;
      border: none;
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      transition: all 0.2s;
    }
    .sim-btn:hover { background: #475569; }
    .sim-btn.primary { background: #0ea5e9; }
    .sim-btn.primary:hover { background: #0284c7; }
    .sim-btn.success { background: #22c55e; }
    .sim-btn.success:hover { background: #16a34a; }

    /* Sound Selection */
    .sounds-section {
      background: #1e293b;
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
    }
    .sounds-section h2 {
      color: #38bdf8;
      margin-bottom: 10px;
      font-size: 1.2rem;
    }
    .sounds-section .description {
      color: #94a3b8;
      margin-bottom: 20px;
      font-size: 0.9rem;
    }
    .sound-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 15px;
    }
    .sound-card {
      background: #0f172a;
      border: 2px solid #334155;
      border-radius: 12px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .sound-card:hover { border-color: #475569; }
    .sound-card.selected {
      border-color: #0ea5e9;
      background: #0c1929;
    }
    .sound-card .sound-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    .sound-card .sound-name {
      font-weight: 600;
      font-size: 1rem;
    }
    .sound-card .sound-icon {
      font-size: 1.5rem;
    }
    .sound-card .sound-desc {
      color: #64748b;
      font-size: 0.85rem;
    }
    .sound-card .play-btn {
      background: #334155;
      border: none;
      color: white;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 12px;
      font-size: 0.85rem;
      transition: background 0.2s;
    }
    .sound-card .play-btn:hover { background: #475569; }

    /* Special Events */
    .events-section {
      background: #1e293b;
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
    }
    .events-section h2 {
      color: #38bdf8;
      margin-bottom: 20px;
      font-size: 1.2rem;
    }
    .event-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 15px;
      background: #0f172a;
      border-radius: 8px;
      margin-bottom: 10px;
    }
    .event-row:last-child { margin-bottom: 0; }
    .event-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .event-icon { font-size: 1.5rem; }
    .event-name { font-weight: 500; }
    .event-desc { color: #64748b; font-size: 0.85rem; }
    .event-row .play-btn {
      background: #334155;
      border: none;
      color: white;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .event-row .play-btn:hover { background: #475569; }

    /* Settings */
    .settings {
      background: #1e293b;
      border-radius: 16px;
      padding: 30px;
    }
    .settings h2 {
      color: #38bdf8;
      margin-bottom: 20px;
      font-size: 1.2rem;
    }
    .setting-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 15px 0;
      border-bottom: 1px solid #334155;
    }
    .setting-row:last-child { border-bottom: none; }
    .setting-label { font-weight: 500; }
    .setting-desc { color: #64748b; font-size: 0.85rem; }
    .volume-slider {
      width: 150px;
      accent-color: #0ea5e9;
    }
    .toggle {
      position: relative;
      width: 50px;
      height: 26px;
    }
    .toggle input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .toggle .slider {
      position: absolute;
      cursor: pointer;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: #334155;
      transition: 0.3s;
      border-radius: 26px;
    }
    .toggle .slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: 0.3s;
      border-radius: 50%;
    }
    .toggle input:checked + .slider { background-color: #0ea5e9; }
    .toggle input:checked + .slider:before { transform: translateX(24px); }

    /* Toast notification */
    .toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: #22c55e;
      color: white;
      padding: 15px 30px;
      border-radius: 8px;
      font-weight: 500;
      opacity: 0;
      transition: all 0.3s;
      z-index: 1000;
    }
    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Notification Sounds Demo</h1>
      <p>Test and choose notification sounds for patient queue updates</p>
    </div>

    <!-- Queue Simulation -->
    <div class="simulation">
      <h2>Queue Simulation</h2>
      <div class="queue-display">
        <div class="position-card" id="positionCard">
          <div class="label">Your Position</div>
          <div class="number" id="position">5</div>
          <div class="sublabel" id="waitTime">~25 min wait</div>
        </div>
      </div>
      <div class="sim-controls">
        <button class="sim-btn" onclick="resetQueue()">Reset to #5</button>
        <button class="sim-btn primary" onclick="moveUp()">Move Up (Next Patient Called)</button>
        <button class="sim-btn success" onclick="yourTurn()">Your Turn!</button>
      </div>
    </div>

    <!-- Position Change Sounds -->
    <div class="sounds-section">
      <h2>Position Change Sound</h2>
      <p class="description">This sound plays each time you move up one position in the queue</p>
      <div class="sound-grid">
        <div class="sound-card selected" data-sound="gentle-pop" onclick="selectSound(this, 'gentle-pop')">
          <div class="sound-header">
            <span class="sound-name">Gentle Pop</span>
            <span class="sound-icon">üîî</span>
          </div>
          <div class="sound-desc">Soft, non-intrusive pop sound</div>
          <button class="play-btn" onclick="event.stopPropagation(); playSound('gentle-pop')">Play</button>
        </div>
        <div class="sound-card" data-sound="chime" onclick="selectSound(this, 'chime')">
          <div class="sound-header">
            <span class="sound-name">Soft Chime</span>
            <span class="sound-icon">üéµ</span>
          </div>
          <div class="sound-desc">Pleasant musical chime</div>
          <button class="play-btn" onclick="event.stopPropagation(); playSound('chime')">Play</button>
        </div>
        <div class="sound-card" data-sound="ding" onclick="selectSound(this, 'ding')">
          <div class="sound-header">
            <span class="sound-name">Simple Ding</span>
            <span class="sound-icon">üõéÔ∏è</span>
          </div>
          <div class="sound-desc">Classic notification ding</div>
          <button class="play-btn" onclick="event.stopPropagation(); playSound('ding')">Play</button>
        </div>
        <div class="sound-card" data-sound="bubble" onclick="selectSound(this, 'bubble')">
          <div class="sound-header">
            <span class="sound-name">Bubble</span>
            <span class="sound-icon">üíß</span>
          </div>
          <div class="sound-desc">Soft bubble pop effect</div>
          <button class="play-btn" onclick="event.stopPropagation(); playSound('bubble')">Play</button>
        </div>
        <div class="sound-card" data-sound="whoosh" onclick="selectSound(this, 'whoosh')">
          <div class="sound-header">
            <span class="sound-name">Whoosh</span>
            <span class="sound-icon">üí®</span>
          </div>
          <div class="sound-desc">Quick swoosh sound</div>
          <button class="play-btn" onclick="event.stopPropagation(); playSound('whoosh')">Play</button>
        </div>
        <div class="sound-card" data-sound="marimba" onclick="selectSound(this, 'marimba')">
          <div class="sound-header">
            <span class="sound-name">Marimba</span>
            <span class="sound-icon">üéπ</span>
          </div>
          <div class="sound-desc">Warm marimba note</div>
          <button class="play-btn" onclick="event.stopPropagation(); playSound('marimba')">Play</button>
        </div>
      </div>
    </div>

    <!-- Special Event Sounds -->
    <div class="events-section">
      <h2>Special Event Sounds</h2>
      <div class="event-row">
        <div class="event-info">
          <span class="event-icon">‚ö†Ô∏è</span>
          <div>
            <div class="event-name">Almost Your Turn (2 patients away)</div>
            <div class="event-desc">Alert sound when patient should start heading to the clinic</div>
          </div>
        </div>
        <button class="play-btn" onclick="playSound('almost-turn')">Play</button>
      </div>
      <div class="event-row">
        <div class="event-info">
          <span class="event-icon">üéâ</span>
          <div>
            <div class="event-name">Your Turn!</div>
            <div class="event-desc">Celebratory sound when it's the patient's turn</div>
          </div>
        </div>
        <button class="play-btn" onclick="playSound('your-turn')">Play</button>
      </div>
      <div class="event-row">
        <div class="event-info">
          <span class="event-icon">‚è∏Ô∏è</span>
          <div>
            <div class="event-name">Doctor Paused</div>
            <div class="event-desc">Notification when doctor marks as away/busy</div>
          </div>
        </div>
        <button class="play-btn" onclick="playSound('paused')">Play</button>
      </div>
    </div>

    <!-- Settings -->
    <div class="settings">
      <h2>Sound Settings</h2>
      <div class="setting-row">
        <div>
          <div class="setting-label">Volume</div>
          <div class="setting-desc">Adjust notification volume</div>
        </div>
        <input type="range" class="volume-slider" id="volume" min="0" max="100" value="70" onchange="updateVolume(this.value)">
      </div>
      <div class="setting-row">
        <div>
          <div class="setting-label">Sound Enabled</div>
          <div class="setting-desc">Turn notification sounds on/off</div>
        </div>
        <label class="toggle">
          <input type="checkbox" id="soundEnabled" checked>
          <span class="slider"></span>
        </label>
      </div>
      <div class="setting-row">
        <div>
          <div class="setting-label">Vibrate (Mobile)</div>
          <div class="setting-desc">Vibrate phone on notifications</div>
        </div>
        <label class="toggle">
          <input type="checkbox" id="vibrateEnabled" checked>
          <span class="slider"></span>
        </label>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // Audio Context for generating sounds
    let audioCtx = null;
    let currentPosition = 5;
    let selectedSound = 'gentle-pop';
    let volume = 0.7;

    function getAudioContext() {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
      return audioCtx;
    }

    // Sound generators using Web Audio API
    const sounds = {
      'gentle-pop': () => {
        const ctx = getAudioContext();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.frequency.setValueAtTime(800, ctx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(400, ctx.currentTime + 0.1);
        gain.gain.setValueAtTime(volume * 0.3, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.15);
        osc.start(ctx.currentTime);
        osc.stop(ctx.currentTime + 0.15);
      },

      'chime': () => {
        const ctx = getAudioContext();
        const frequencies = [523.25, 659.25, 783.99]; // C5, E5, G5
        frequencies.forEach((freq, i) => {
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.type = 'sine';
          osc.frequency.value = freq;
          gain.gain.setValueAtTime(0, ctx.currentTime + i * 0.1);
          gain.gain.linearRampToValueAtTime(volume * 0.2, ctx.currentTime + i * 0.1 + 0.02);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + i * 0.1 + 0.4);
          osc.start(ctx.currentTime + i * 0.1);
          osc.stop(ctx.currentTime + i * 0.1 + 0.4);
        });
      },

      'ding': () => {
        const ctx = getAudioContext();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.type = 'sine';
        osc.frequency.value = 880;
        gain.gain.setValueAtTime(volume * 0.4, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);
        osc.start(ctx.currentTime);
        osc.stop(ctx.currentTime + 0.5);
      },

      'bubble': () => {
        const ctx = getAudioContext();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.type = 'sine';
        osc.frequency.setValueAtTime(150, ctx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(600, ctx.currentTime + 0.1);
        gain.gain.setValueAtTime(volume * 0.3, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);
        osc.start(ctx.currentTime);
        osc.stop(ctx.currentTime + 0.2);
      },

      'whoosh': () => {
        const ctx = getAudioContext();
        const bufferSize = ctx.sampleRate * 0.2;
        const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
        const data = buffer.getChannelData(0);
        for (let i = 0; i < bufferSize; i++) {
          data[i] = (Math.random() * 2 - 1) * (1 - i / bufferSize);
        }
        const noise = ctx.createBufferSource();
        const filter = ctx.createBiquadFilter();
        const gain = ctx.createGain();
        noise.buffer = buffer;
        filter.type = 'bandpass';
        filter.frequency.setValueAtTime(1000, ctx.currentTime);
        filter.frequency.exponentialRampToValueAtTime(3000, ctx.currentTime + 0.1);
        filter.frequency.exponentialRampToValueAtTime(500, ctx.currentTime + 0.2);
        noise.connect(filter);
        filter.connect(gain);
        gain.connect(ctx.destination);
        gain.gain.setValueAtTime(volume * 0.3, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);
        noise.start(ctx.currentTime);
        noise.stop(ctx.currentTime + 0.2);
      },

      'marimba': () => {
        const ctx = getAudioContext();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.type = 'triangle';
        osc.frequency.value = 440;
        gain.gain.setValueAtTime(volume * 0.5, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
        osc.start(ctx.currentTime);
        osc.stop(ctx.currentTime + 0.3);
      },

      'almost-turn': () => {
        const ctx = getAudioContext();
        // Two-tone alert
        [0, 0.15, 0.3].forEach((delay) => {
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.type = 'sine';
          osc.frequency.value = delay === 0.15 ? 880 : 660;
          gain.gain.setValueAtTime(volume * 0.4, ctx.currentTime + delay);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + delay + 0.12);
          osc.start(ctx.currentTime + delay);
          osc.stop(ctx.currentTime + delay + 0.12);
        });
      },

      'your-turn': () => {
        const ctx = getAudioContext();
        // Triumphant fanfare
        const notes = [523.25, 659.25, 783.99, 1046.50]; // C5, E5, G5, C6
        notes.forEach((freq, i) => {
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.type = 'square';
          osc.frequency.value = freq;
          const startTime = ctx.currentTime + i * 0.12;
          gain.gain.setValueAtTime(0, startTime);
          gain.gain.linearRampToValueAtTime(volume * 0.2, startTime + 0.02);
          gain.gain.setValueAtTime(volume * 0.2, startTime + 0.1);
          gain.gain.exponentialRampToValueAtTime(0.01, startTime + (i === 3 ? 0.5 : 0.15));
          osc.start(startTime);
          osc.stop(startTime + (i === 3 ? 0.5 : 0.15));
        });
      },

      'paused': () => {
        const ctx = getAudioContext();
        // Descending tone
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.type = 'sine';
        osc.frequency.setValueAtTime(600, ctx.currentTime);
        osc.frequency.linearRampToValueAtTime(300, ctx.currentTime + 0.3);
        gain.gain.setValueAtTime(volume * 0.3, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.4);
        osc.start(ctx.currentTime);
        osc.stop(ctx.currentTime + 0.4);
      }
    };

    function playSound(soundName) {
      if (!document.getElementById('soundEnabled').checked) return;

      if (sounds[soundName]) {
        sounds[soundName]();
      }

      // Vibrate on mobile if enabled
      if (document.getElementById('vibrateEnabled').checked && navigator.vibrate) {
        navigator.vibrate(100);
      }
    }

    function selectSound(card, soundName) {
      document.querySelectorAll('.sound-card').forEach(c => c.classList.remove('selected'));
      card.classList.add('selected');
      selectedSound = soundName;
      playSound(soundName);
      showToast(`Selected: ${card.querySelector('.sound-name').textContent}`);
    }

    function updateVolume(val) {
      volume = val / 100;
    }

    function moveUp() {
      if (currentPosition > 1) {
        currentPosition--;
        updatePositionDisplay();
        playSound(selectedSound);

        // Check for special events
        if (currentPosition === 2) {
          setTimeout(() => playSound('almost-turn'), 500);
          showToast('Almost your turn! Please head to the clinic.');
        }
      } else if (currentPosition === 1) {
        yourTurn();
      }
    }

    function yourTurn() {
      currentPosition = 0;
      document.getElementById('position').textContent = 'üéâ';
      document.getElementById('waitTime').textContent = "It's your turn!";
      document.getElementById('positionCard').classList.add('highlight');
      playSound('your-turn');
      showToast("C'EST VOTRE TOUR!");
      setTimeout(() => {
        document.getElementById('positionCard').classList.remove('highlight');
      }, 500);
    }

    function resetQueue() {
      currentPosition = 5;
      updatePositionDisplay();
      showToast('Queue reset to position #5');
    }

    function updatePositionDisplay() {
      const posEl = document.getElementById('position');
      const waitEl = document.getElementById('waitTime');
      const card = document.getElementById('positionCard');

      posEl.textContent = currentPosition;
      waitEl.textContent = `~${currentPosition * 5} min wait`;

      card.classList.add('highlight');
      setTimeout(() => card.classList.remove('highlight'), 500);
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      // Resume AudioContext on first user interaction (required by browsers)
      document.body.addEventListener('click', () => {
        if (audioCtx && audioCtx.state === 'suspended') {
          audioCtx.resume();
        }
      }, { once: true });
    });
  </script>
</body>
</html>
